LEVEL_VERSION(1)

SET_GENERATE_SPEED(350)

START_MONEY(PLAYER0,20000)
START_MONEY(PLAYER1,200000)

MAX_CREATURES(PLAYER0,5)
MAX_CREATURES(PLAYER1,5)

COMPUTER_PLAYER(PLAYER1,9)


DEAD_CREATURES_RETURN_TO_POOL(1)

ADD_CREATURE_TO_POOL(TROLL,30)
ADD_CREATURE_TO_POOL(SORCEROR,10)
ADD_CREATURE_TO_POOL(BILE_DEMON,30)
ADD_CREATURE_TO_POOL(DARK_MISTRESS,30)
ADD_CREATURE_TO_POOL(VAMPIRE,20)
ADD_CREATURE_TO_POOL(DRAGON,30)
ADD_CREATURE_TO_POOL(HELL_HOUND,30)
ADD_CREATURE_TO_POOL(ORC,20)
ADD_CREATURE_TO_POOL(DEMONSPAWN,30)
ADD_CREATURE_TO_POOL(FLY,40)
ADD_CREATURE_TO_POOL(BUG,40)
ADD_CREATURE_TO_POOL(WIZARD,30)

REM Creature availability

CREATURE_AVAILABLE(ALL_PLAYERS,DRAGON,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,HELL_HOUND,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,ORC,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,BILE_DEMON,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,FLY,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,BUG,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,WIZARD,1,1)

REM Room availability
ROOM_AVAILABLE(ALL_PLAYERS,TREASURE,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,LAIR,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,GARDEN,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,TRAINING,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,RESEARCH,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,WORKSHOP,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,BARRACKS,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,GUARD_POST,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,BRIDGE,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,PRISON,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,TORTURE,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,SCAVENGER,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,TEMPLE,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,GRAVEYARD,0,0)

REM Spells availability
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_POSSESS,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_HAND,1,1)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_IMP,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_SLAP,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_SIGHT,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_OBEY,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_CALL_TO_ARMS,1,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_HEAL_CREATURE,1,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_SPEED,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_LIGHTNING,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_PROTECT,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_CONCEAL,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_DISEASE,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_CAVE_IN,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_CHICKEN,0,0)

CREATE_PARTY(DEFEAT)
ADD_TO_PARTY(DEFEAT,AVATAR,10,0,ATTACK_ENEMIES,0)

IF(PLAYER0,GAME_TURN >= 10)
QUICK_INFORMATION(1,"守护者！控制这只精灵，并迅速赶过来。探索关于这个王国的更多信息。",1)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_POSSESS,1,1)
ENDIF

IF_ACTION_POINT(1,PLAYER0)
QUICK_INFORMATION(2,"守护者，你的精灵发现了一种神秘的力量，可以在这里建造储金室、巢穴、孵化室甚至训练室。此外，你的仆从还找到了一些关于如何在熔岩上建造一座基本桥梁的信息。更多的精灵也会前来投奔你。在你使用附身魔法的时间耗尽之前，快来这里。打破北面的门，救出小鬼！",2)
	ROOM_AVAILABLE(PLAYER0,TREASURE,1,1)
	ROOM_AVAILABLE(PLAYER0,LAIR,1,1)
	ROOM_AVAILABLE(PLAYER0,GARDEN,1,1)
	ROOM_AVAILABLE(PLAYER0,TRAINING,1,1)
	ROOM_AVAILABLE(PLAYER0,BRIDGE,1,1)
	
ENDIF

IF(PLAYER0,IMP >= 2)
QUICK_OBJECTIVE(3,"一旦你得到了小鬼，他们就会透露关于这个王国的宝贵信息。哈尔的爪牙们正守卫着魔法书，很可能已经袭击了东面的另一个守护者。你的目标是占领敌人的地下城并杀死哈尔的爪牙！",PLAYER0)
ENDIF

IF_AVAILABLE(PLAYER0,POWER_DESTROY_WALLS >= 1)
QUICK_OBJECTIVE(4,"干得漂亮，守护者！现在攻入地下城，实现你的目标。",3)
ENDIF

IF(PLAYER1,DUNGEON_DESTROYED == 1)
	IF_CONTROLS(PLAYER_GOOD,TOTAL_CREATURES <= 0)
		QUICK_OBJECTIVE(5,"干得好，守护者。哈尔的爪牙被打败了，你占领了敌人的地下城。你征服了这片土地！",ALL_PLAYERS)
		WIN_GAME
	ENDIF
ENDIF


IF(PLAYER0,TOTAL_CREATURES >= 1)
	SET_FLAG(PLAYER0,FLAG1,1)
ENDIF

REM If the player has no creatures anymore, he loses the game.
IF(PLAYER0,FLAG1 = 1)
	IF(PLAYER0,TOTAL_CREATURES <= 0)
		QUICK_OBJECTIVE(6,"你没有一只怪物了，这意味着你已经失败了，守护者！",PLAYER0)
		LOSE_GAME
	ENDIF
ENDIF

REM at 5 minutes into the game, take away the icon for the spell Possess
IF(PLAYER0,GAME_TURN >= 6000)
	MAGIC_AVAILABLE(ALL_PLAYERS,POWER_POSSESS,0,0)
	QUICK_INFORMATION(8,"你的附身魔法能量已经耗尽了，守护者！",ALL_PLAYERS)
ENDIF

REM At 5 minutes, if the player has no imps left, the player is defeated and the avatar spawns.
IF(PLAYER0,GAME_TURN >= 6000)
	IF_CONTROLS(PLAYER0, IMP <= 0)
		ADD_PARTY_TO_LEVEL(PLAYER_GOOD,DEFEAT,4,1)
		QUICK_OBJECTIVE(7,"你未能及时拯救你的小鬼。你已经失败了！",ALL_PLAYERS)
		LOSE_GAME
	ENDIF
ENDIF