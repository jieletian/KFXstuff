LEVEL_VERSION(1)

SET_GENERATE_SPEED(50)

MAX_CREATURES(PLAYER0,5)
MAX_CREATURES(PLAYER3,15)

START_MONEY(PLAYER0,200000)
START_MONEY(PLAYER3,200000)

COMPUTER_PLAYER(PLAYER3,0)

ALLY_PLAYERS(PLAYER0,PLAYER3,1)
ALLY_PLAYERS(PLAYER_GOOD,PLAYER3,0)

ADD_CREATURE_TO_POOL(WIZARD,20)
ADD_CREATURE_TO_POOL(BARBARIAN,20)
ADD_CREATURE_TO_POOL(ARCHER,20)
ADD_CREATURE_TO_POOL(MONK,20)
ADD_CREATURE_TO_POOL(DWARFA,20)
ADD_CREATURE_TO_POOL(KNIGHT,20)
ADD_CREATURE_TO_POOL(AVATAR,20)
ADD_CREATURE_TO_POOL(TUNNELLER,20)
ADD_CREATURE_TO_POOL(WITCH,20)
ADD_CREATURE_TO_POOL(GIANT,20)
ADD_CREATURE_TO_POOL(FAIRY,20)
ADD_CREATURE_TO_POOL(THIEF,20)
ADD_CREATURE_TO_POOL(SAMURAI,20)
ADD_CREATURE_TO_POOL(IMP,20)
ADD_CREATURE_TO_POOL(HORNY,20)
ADD_CREATURE_TO_POOL(SKELETON,20)
ADD_CREATURE_TO_POOL(TROLL,20)
ADD_CREATURE_TO_POOL(DRAGON,20)
ADD_CREATURE_TO_POOL(DEMONSPAWN,20)
ADD_CREATURE_TO_POOL(FLY,20)
ADD_CREATURE_TO_POOL(DARK_MISTRESS,20)
ADD_CREATURE_TO_POOL(SORCEROR,20)
ADD_CREATURE_TO_POOL(BILE_DEMON,20)
ADD_CREATURE_TO_POOL(BUG,20)
ADD_CREATURE_TO_POOL(VAMPIRE,20)
ADD_CREATURE_TO_POOL(SPIDER,20)
ADD_CREATURE_TO_POOL(HELL_HOUND,20)
ADD_CREATURE_TO_POOL(TENTACLE,20)
ADD_CREATURE_TO_POOL(GHOST,20)
ADD_CREATURE_TO_POOL(ORC,20)

CREATURE_AVAILABLE(ALL_PLAYERS,WIZARD,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,BARBARIAN,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,ARCHER,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,MONK,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,DWARFA,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,KNIGHT,0,0)
CREATURE_AVAILABLE(PLAYER3,AVATAR,1,0)
CREATURE_AVAILABLE(PLAYER0,AVATAR,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,TUNNELLER,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,WITCH,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,GIANT,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,FAIRY,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,THIEF,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,SAMURAI,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,IMP,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,HORNY,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,SKELETON,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,TROLL,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,DRAGON,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,DEMONSPAWN,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,FLY,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,DARK_MISTRESS,0,0)
CREATURE_AVAILABLE(ALL_PLAYERS,SORCEROR,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,BILE_DEMON,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,BUG,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,VAMPIRE,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,SPIDER,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,HELL_HOUND,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,GHOST,1,0)
CREATURE_AVAILABLE(ALL_PLAYERS,TENTACLE,1,1)
CREATURE_AVAILABLE(ALL_PLAYERS,ORC,1,1)

DEAD_CREATURES_RETURN_TO_POOL(0)

ROOM_AVAILABLE(ALL_PLAYERS,GUARD_POST,0,0)
ROOM_AVAILABLE(PLAYER0,TREASURE,1,1)
ROOM_AVAILABLE(PLAYER3,TREASURE,0,0)
ROOM_AVAILABLE(PLAYER3,RESEARCH,0,0)
ROOM_AVAILABLE(PLAYER0,RESEARCH,1,1)
ROOM_AVAILABLE(PLAYER3,GARDEN,0,0)
ROOM_AVAILABLE(PLAYER0,GARDEN,1,1)
ROOM_AVAILABLE(PLAYER3,LAIR,0,0)
ROOM_AVAILABLE(PLAYER0,LAIR,1,1)
ROOM_AVAILABLE(PLAYER0,WORKSHOP,1,0)
ROOM_AVAILABLE(PLAYER3,WORKSHOP,1,0)
ROOM_AVAILABLE(PLAYER0,GRAVEYARD,0,0)
ROOM_AVAILABLE(PLAYER3,GRAVEYARD,0,0)
ROOM_AVAILABLE(PLAYER0,PRISON,1,0)
ROOM_AVAILABLE(PLAYER3,PRISON,1,0)
ROOM_AVAILABLE(PLAYER0,TORTURE,1,0)
ROOM_AVAILABLE(PLAYER3,TRAINING,0,0)
ROOM_AVAILABLE(PLAYER0,TRAINING,1,1)
ROOM_AVAILABLE(ALL_PLAYERS,SCAVENGER,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,BARRACKS,0,0)
ROOM_AVAILABLE(ALL_PLAYERS,TEMPLE,0,0)
ROOM_AVAILABLE(PLAYER0,BRIDGE,0,0)
ROOM_AVAILABLE(PLAYER3,BRIDGE,0,0)
MAGIC_AVAILABLE(PLAYER0,POWER_POSSESS,0,0)
MAGIC_AVAILABLE(PLAYER3,POWER_POSSESS,1,1)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_HAND,1,1)
MAGIC_AVAILABLE(PLAYER0,POWER_IMP,1,0)
MAGIC_AVAILABLE(PLAYER3,POWER_IMP,0,0)
MAGIC_AVAILABLE(PLAYER0,POWER_SLAP,1,1)
MAGIC_AVAILABLE(PLAYER3,POWER_SLAP,1,1)
MAGIC_AVAILABLE(PLAYER0,POWER_SIGHT,0,0)
MAGIC_AVAILABLE(PLAYER3,POWER_SIGHT,1,0)
MAGIC_AVAILABLE(PLAYER0,POWER_CALL_TO_ARMS,1,0)
MAGIC_AVAILABLE(PLAYER3,POWER_CALL_TO_ARMS,1,0)
MAGIC_AVAILABLE(PLAYER0,POWER_CAVE_IN,0,0)
MAGIC_AVAILABLE(PLAYER3,POWER_CAVE_IN,1,0)
MAGIC_AVAILABLE(PLAYER0,POWER_HEAL_CREATURE,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_HOLD_AUDIENCE,1,0)
MAGIC_AVAILABLE(PLAYER0,POWER_CHICKEN,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_SPEED,0,0)
MAGIC_AVAILABLE(PLAYER0,POWER_LIGHTNING,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_CONCEAL,0,0)
MAGIC_AVAILABLE(PLAYER0,POWER_DESTROY_WALLS,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_DISEASE,0,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_PROTECT,1,0)
MAGIC_AVAILABLE(ALL_PLAYERS,POWER_ARMAGEDDON,0,0)

DOOR_AVAILABLE(ALL_PLAYERS,WOOD,1,0)
TRAP_AVAILABLE(ALL_PLAYERS,ALARM,1,0)
DOOR_AVAILABLE(ALL_PLAYERS,BRACED,1,0)
TRAP_AVAILABLE(ALL_PLAYERS,POISON_GAS,1,0)
TRAP_AVAILABLE(ALL_PLAYERS,LAVA,0,0)
DOOR_AVAILABLE(ALL_PLAYERS,STEEL,0,0)
TRAP_AVAILABLE(ALL_PLAYERS,BOULDER,0,0)
DOOR_AVAILABLE(ALL_PLAYERS,MAGIC,0,0)
TRAP_AVAILABLE(ALL_PLAYERS,LIGHTNING,0,0)
TRAP_AVAILABLE(ALL_PLAYERS,WORD_OF_POWER,0,0)

REVEAL_MAP_RECT(PLAYER0,210,25,7,7)
REVEAL_MAP_RECT(PLAYER0,242,41,7,7)
REVEAL_MAP_RECT(PLAYER0,170,2,5,5)


CREATE_PARTY(DESTROYERS)


ADD_TO_PARTY(DESTROYERS,AVATAR,10,0,ATTACK_DUNGEON_HEART,0)
ADD_TO_PARTY(DESTROYERS,SORCEROR,10,0,ATTACK_DUNGEON_HEART,0)
ADD_TO_PARTY(DESTROYERS,KNIGHT,10,0,ATTACK_DUNGEON_HEART,0)
ADD_TO_PARTY(DESTROYERS,AVATAR,10,0,ATTACK_DUNGEON_HEART,0)
ADD_TO_PARTY(DESTROYERS,KNIGHT,10,0,ATTACK_DUNGEON_HEART,0)
ADD_TO_PARTY(DESTROYERS,AVATAR,10,0,ATTACK_DUNGEON_HEART,0)
ADD_TO_PARTY(DESTROYERS,WIZARD,10,0,ATTACK_DUNGEON_HEART,0)

CREATE_PARTY(FIRST_STRIKE)


ADD_TO_PARTY(FIRST_STRIKE,FAIRY,1,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(FIRST_STRIKE,ARCHER,1,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(FIRST_STRIKE,ARCHER,1,0,ATTACK_DUNGEON_HEART,3)

CREATE_PARTY(SECOND_STRIKE)


ADD_TO_PARTY(SECOND_STRIKE,FAIRY,4,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SECOND_STRIKE,ARCHER,3,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SECOND_STRIKE,ARCHER,3,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SECOND_STRIKE,SAMURAI,5,0,ATTACK_DUNGEON_HEART,3)

CREATE_PARTY(THIRD_STRIKE)


ADD_TO_PARTY(THIRD_STRIKE,VAMPIRE,4,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(THIRD_STRIKE,WIZARD,4,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(THIRD_STRIKE,WIZARD,4,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(THIRD_STRIKE,SAMURAI,4,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(THIRD_STRIKE,DARK_MISTRESS,4,0,ATTACK_DUNGEON_HEART,3)

CREATE_PARTY(FOURTH_STRIKE)


ADD_TO_PARTY(FOURTH_STRIKE,HELL_HOUND,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(FOURTH_STRIKE,HELL_HOUND,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(FOURTH_STRIKE,HELL_HOUND,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(FOURTH_STRIKE,HELL_HOUND,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(FOURTH_STRIKE,THIEF,7,0,ATTACK_DUNGEON_HEART,3)


CREATE_PARTY(FIFTH_STRIKE)


ADD_TO_PARTY(FIFTH_STRIKE,TROLL,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(FIFTH_STRIKE,ORC,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(FIFTH_STRIKE,TROLL,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(FIFTH_STRIKE,ORC,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(FIFTH_STRIKE,GIANT,7,0,ATTACK_DUNGEON_HEART,3)

CREATE_PARTY(SIXTH_STRIKE)


ADD_TO_PARTY(SIXTH_STRIKE,BARBARIAN,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SIXTH_STRIKE,BARBARIAN,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SIXTH_STRIKE,BARBARIAN,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SIXTH_STRIKE,BARBARIAN,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SIXTH_STRIKE,BARBARIAN,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SIXTH_STRIKE,BARBARIAN,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SIXTH_STRIKE,BARBARIAN,6,0,ATTACK_DUNGEON_HEART,3)

CREATE_PARTY(SEVENTH_STRIKE)


ADD_TO_PARTY(SEVENTH_STRIKE,WIZARD,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SEVENTH_STRIKE,WIZARD,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SEVENTH_STRIKE,WIZARD,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SEVENTH_STRIKE,WIZARD,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SEVENTH_STRIKE,WIZARD,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SEVENTH_STRIKE,WIZARD,6,0,ATTACK_DUNGEON_HEART,3)
ADD_TO_PARTY(SEVENTH_STRIKE,SORCEROR,8,0,ATTACK_DUNGEON_HEART,3)



IF(PLAYER0,GAME_TURN >= 10)
QUICK_OBJECTIVE(1,"出乎意料的是，在这个王国里，你有一位名叫马蒂的盟友守卫者。他的目标和你类似：消灭哈尔，保卫自己的领地。不幸的是，马蒂无法支持你，因为 哈尔使用了加固墙壁法术，这意味着马蒂无法到达北面的房间。幸运的是，在上一个王国，你得到了一些关于哈尔的入口的信息。你可以看到魔法书和敌人。拿到魔法书，打败哈尔，帮助马蒂完成任务！不过，由于哈尔的领地拥有魔法，你的能力在这里会受到一些限制，所以一定要小心。附近可能到处都有陷阱。",PLAYER0)
ENDIF

IF(PLAYER0,GAME_TURN >= 500)
QUICK_INFORMATION(2,"守护者，马蒂可能会成为你的坚强后盾。不要让他失望！不要破坏他的地下城心脏，也不要占领他的土地。马蒂允许你使用一些领地，请放心使用！",PLAYER3)
ENDIF

IF_AVAILABLE(PLAYER0,POWER_CALL_TO_ARMS >= 1)
QUICK_INFORMATION(3,"守护者，给你个小建议，你需要建造一座监狱。一旦有了审讯室，它也会派上用场。",PLAYER0)
TUTORIAL_FLASH_BUTTON(11,-1)
ENDIF

IF_AVAILABLE(PLAYER0,POWER_DESTROY_WALLS >= 1)
MAGIC_AVAILABLE(PLAYER3,POWER_IMP,1,1)
QUICK_OBJECTIVE(4,"干得好，守护者！马蒂现在有能力使用制造小鬼魔法了，用你的 破坏墙壁魔法打破哈尔的围墙！",PLAYER3)
ENDIF


IF(PLAYER0,GAME_TURN >= 10000)
ADD_PARTY_TO_LEVEL(PLAYER_GOOD,FIRST_STRIKE,-1,1)
QUICK_INFORMATION(5,"守护者，哈尔的爪牙们来消灭马蒂了！",-1)
ENDIF

IF(PLAYER0,GAME_TURN >= 20000)
ADD_PARTY_TO_LEVEL(PLAYER_GOOD,SECOND_STRIKE,-1,1)
ENDIF

IF(PLAYER0,GAME_TURN >= 30000)
ADD_PARTY_TO_LEVEL(PLAYER_GOOD,THIRD_STRIKE,-1,1)
ENDIF

IF(PLAYER0,GAME_TURN >= 45000)
ADD_PARTY_TO_LEVEL(PLAYER_GOOD,FOURTH_STRIKE,-1,1)
ENDIF

IF(PLAYER0,GAME_TURN >= 60000)
ADD_PARTY_TO_LEVEL(PLAYER_GOOD,FIFTH_STRIKE,-1,1)
ENDIF

IF(PLAYER0,GAME_TURN >= 80000)
ADD_PARTY_TO_LEVEL(PLAYER_GOOD,SIXTH_STRIKE,-1,1)
ENDIF


IF(PLAYER0,GAME_TURN >= 100000)
IF(PLAYER0,FLAG1 = 1)
ADD_PARTY_TO_LEVEL(PLAYER_GOOD,SEVENTH_STRIKE,-1,1)
QUICK_INFORMATION(6,"守护者，保护马蒂！",-1)
ENDIF
ENDIF

IF(PLAYER3,TOTAL_CREATURES >= 1)
QUICK_OBJECTIVE(8,"嗯... 不知怎的，一种奇怪的感觉涌上心头。你不觉得吗，守护者？",PLAYER3)
ALLY_PLAYERS(PLAYER_GOOD,PLAYER3,1)
SET_FLAG(PLAYER0,FLAG1,1)
ENDIF

IF(PLAYER3,TOTAL_CREATURES >= 10)
QUICK_OBJECTIVE(9,"我的天啊！这是个陷阱！全是陷阱! 看这里!",-2)
ADD_PARTY_TO_LEVEL(PLAYER_GOOD,DESTROYERS,-2,2)
ADD_CREATURE_TO_LEVEL(PLAYER3,AVATAR,PLAYER3,10,10,0)
ALLY_PLAYERS(PLAYER0,PLAYER3,0)
SET_TIMER(PLAYER0,TIMER0)
ENDIF

IF(PLAYER0,TIMER0 >= 1000)
QUICK_INFORMATION(10,"看！这是个陷阱！马蒂背叛了你！都是装的！",PLAYER3)
ENDIF

IF(PLAYER0,TIMER0 >= 1400)
QUICK_OBJECTIVE(11,"守护者，集结所有力量对付那些哈尔的特工！他们都打算除掉你！",-2)
ENDIF

IF(PLAYER0,TIMER0 >= 4000)
QUICK_OBJECTIVE(12,"没用的！在你的地下城心脏被摧毁之前，快逃离这里吧！把小鬼扔进来，然后附身在它身上，让它逃出这里！它最好能穿过迷宫！",1)
ADD_PARTY_TO_LEVEL(PLAYER_GOOD,DESTROYERS,-2,2)
MAGIC_AVAILABLE(PLAYER0,POWER_POSSESS,1,1)
ENDIF

IF_ACTION_POINT(2,PLAYER0)
QUICK_OBJECTIVE(13,"很好，你成功逃脱了！(按空格键进入下一关！）",PLAYER0)
WIN_GAME
ENDIF

IF(PLAYER3,DUNGEON_DESTROYED==1)
IF(PLAYER0,TIMER0 <= 10)
IF(PLAYER0,FLAG1==0)
QUICK_OBJECTIVE(14,"马蒂被干掉了。你失去了支持，这意味着失败。",PLAYER3)
LOSE_GAME
ENDIF
ENDIF